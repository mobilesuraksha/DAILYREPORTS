<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ram Kishan's Sweets - Cloud Manager (Final Fixed)</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        /* --- GENERAL STYLES --- */
        body { font-family: 'Poppins', sans-serif; margin: 0; padding: 0; background-color: #f4f7f6; color: #333; font-size: 13px; }
        .container { max-width: 1600px; margin: 20px auto; padding: 25px; background-color: #ffffff; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08); border-radius: 12px; }
        h1 { color: #2c3e50; font-weight: 700; border-bottom: 3px solid #3498db; padding-bottom: 10px; margin-bottom: 25px; }
        h2 { color: #34495e; font-weight: 600; margin-top: 0; margin-bottom: 20px; border-left: 5px solid #3498db; padding-left: 10px; font-size: 18px; }

        /* --- LOGIN OVERLAY --- */
        #loginOverlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(44, 62, 80, 0.95); z-index: 9999; display: flex; justify-content: center; align-items: center; }
        .login-box { background: white; padding: 40px; border-radius: 10px; width: 350px; text-align: center; box-shadow: 0 10px 30px rgba(0,0,0,0.3); }
        .login-box input { width: 100%; padding: 12px; margin-bottom: 15px; border: 1px solid #ccc; border-radius: 5px; box-sizing: border-box; }
        
        /* --- TABS --- */
        .tab-menu { display: flex; flex-wrap: wrap; gap: 5px; margin-bottom: 25px; border-bottom: 2px solid #e0e0e0; }
        .tab-button { background-color: #f1f1f1; border: none; outline: none; cursor: pointer; padding: 10px 15px; transition: 0.3s; font-size: 13px; font-weight: 600; color: #555; border-radius: 5px 5px 0 0; flex-grow: 1; text-align: center; }
        .tab-button:hover { background-color: #ddd; color: #000; }
        .tab-button.active { background-color: #3498db; color: white; }
        
        /* Tab Specific Colors */
        .tab-button[data-tab="productionTab"] { background-color: #fff3e0; color: #d35400; }
        .tab-button[data-tab="productionTab"].active { background-color: #d35400; color: white; }
        .tab-button[data-tab="packingTab"] { background-color: #e8f5e9; color: #2e7d32; }
        .tab-button[data-tab="packingTab"].active { background-color: #2e7d32; color: white; }
        .tab-button[data-tab="splitTab"] { background-color: #fce4ec; color: #c2185b; }
        .tab-button[data-tab="splitTab"].active { background-color: #c2185b; color: white; }
        .tab-button[data-tab="masterSummaryTab"] { background-color: #e0f7fa; color: #006064; }
        .tab-button[data-tab="masterSummaryTab"].active { background-color: #006064; color: white; }

        .tab-content { display: none; animation: fadeIn 0.3s; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* --- FORMS & INPUTS --- */
        .form-row { display: flex; gap: 15px; flex-wrap: wrap; margin-bottom: 15px; }
        .form-group { flex: 1; min-width: 140px; }
        .form-group label { display: block; margin-bottom: 5px; font-weight: 500; font-size: 12px; color: #666; }
        input, select, textarea { width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; font-family: inherit; font-size: 13px; transition: border 0.3s; }
        input:focus, select:focus { border-color: #3498db; outline: none; box-shadow: 0 0 5px rgba(52,152,219,0.3); }

        /* --- ADMIN CARDS --- */
        .admin-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-top: 20px; }
        .admin-card { background: white; border-radius: 10px; padding: 20px; text-align: center; box-shadow: 0 4px 15px rgba(0,0,0,0.05); transition: transform 0.2s; border-top: 4px solid #ccc; }
        .admin-card:hover { transform: translateY(-5px); }
        .admin-card h3 { margin: 10px 0; font-size: 16px; color: #444; }
        .stat-badge { background: #eee; padding: 3px 8px; border-radius: 20px; font-size: 11px; font-weight: bold; }
        .icon-large { font-size: 30px; margin-bottom: 10px; display: block; }

        /* --- BOX GROUP STYLING --- */
        .box-group-container { border: 2px solid #3498db; background-color: #f0f8ff; border-radius: 8px; padding: 15px; margin-bottom: 20px; position: relative; }
        .box-group-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; padding-bottom: 10px; border-bottom: 1px solid #b3e5fc; }
        .box-group-title { font-weight: 700; color: #2980b9; font-size: 15px; }
        .item-list-container { background-color: white; padding: 10px; border-radius: 6px; border: 1px solid #ddd; }
        .item-row { display: flex; gap: 10px; align-items: flex-end; margin-bottom: 8px; border-bottom: 1px dashed #eee; padding-bottom: 8px; }
        
        #subTotal, #totalAmount, #balanceShow { background-color: #eaf2f8; color: #2980b9; font-weight: 700; cursor: not-allowed; }
        #totalAmount { background-color: #d1f2eb; color: #27ae60; font-size: 16px; border: 2px solid #27ae60; }
        #balanceShow { background-color: #fef9e7; color: #d35400; }

        /* Buttons */
        .btn { padding: 8px 15px; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; transition: 0.2s; font-size: 13px; }
        .btn-success { background-color: #27ae60; color: white; width: 100%; margin-top: 10px; font-size: 16px; padding:12px; }
        .btn-primary { background-color: #3498db; color: white; }
        .btn-warning { background-color: #f39c12; color: white; }
        .btn-danger { background-color: #e74c3c; color: white; }
        .btn-dark { background-color: #34495e; color: white; }
        .btn-logout { background-color: #34495e; color: white; float: right; margin-top: -55px; }
        .btn-sm { padding: 4px 10px; font-size: 11px; }

        /* Tables */
        .table-responsive { overflow-x: auto; margin-top: 20px; }
        .data-table { width: 100%; border-collapse: collapse; font-size: 12px; background-color: white; table-layout: fixed; }
        .data-table th, .data-table td { padding: 6px 8px; border: 1px solid #eee; text-align: left; vertical-align: top; word-wrap: break-word;}
        .data-table th { background-color: #f2f2f2; color: #333; font-weight: 600; }
        
        /* Summary Dashboard */
        #summaryDashboard, #monthDashboard { display: flex; gap: 10px; margin-bottom: 15px; flex-wrap: wrap; }
        .summary-card { flex: 1; min-width: 120px; padding: 10px; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.05); border-left: 4px solid #ccc; background-color: white; display: flex; flex-direction: column; justify-content: center; }
        .summary-card h4 { margin: 0 0 2px 0; font-size: 10px; color: #555; text-transform: uppercase; } 
        .summary-card .value { font-size: 16px; font-weight: 700; color: #333; } 

        /* Badges */
        .mode-badge { display: block; width: 100%; padding: 4px 8px; border-radius: 6px; font-size: 11px; margin-bottom: 3px; border-left-width: 4px !important; }
        .badge-actions { float: right; }
        .btn-icon { background: none; border: none; cursor: pointer; font-size: 14px; padding: 0 2px; margin-left: 3px; font-weight: bold; }
        .icon-edit { color: #2980b9; } .icon-del { color: #c0392b; }

        /* Ledger Summary */
        .ledger-summary-grid { display: flex; justify-content: flex-end; gap: 15px; margin-top: 20px; border-top: 2px solid #eee; padding-top: 15px; }
        .ls-item { padding: 10px 20px; border-radius: 8px; background-color: white; border-left: 5px solid #ccc; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .ls-item h4 { margin: 0; font-size: 11px; color: #666; }
        .ls-item .value { font-size: 18px; font-weight: 700; }
        .ls-item.debit { border-left-color: #2196f3; background:#e3f2fd; } 
        .ls-item.credit { border-left-color: #4caf50; background:#e8f5e9; } 
        .ls-item.balance { border-left-color: #f44336; background:#ffebee; }

        #cashierSummaryTable tbody tr td { font-weight: bold; font-size: 13px; }

        /* Notifications */
        .bell-btn { background: none; border: none; font-size: 24px; cursor: pointer; margin-right: 15px; position: relative; }
        .bell-dot { position: absolute; top: 0; right: 0; width: 10px; height: 10px; background: red; border-radius: 50%; display: none; }
        .notif-item { background: #fff; padding: 15px; border-radius: 8px; border-left: 5px solid #f39c12; margin-bottom: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .notif-header { display: flex; justify-content: space-between; margin-bottom: 5px; font-weight: bold; }
        .notif-actions { display: flex; gap: 5px; margin-top: 10px; }

        /* PRINT */
        .ledger-print-head, .print-header-date, .print-footer { display: none; }
        @media print {
            @page { size: A4 portrait; margin: 10mm; }
            body { background: white; font-size: 12px; }
            .container { box-shadow: none; margin: 0; padding: 0; max-width: 100%; width: 100%; border: none; }
            .tab-menu, .btn, .filter-controls-screen, h1, #reportsTab, .badge-actions, .bell-btn { display: none !important; }
            .no-print { display: none !important; }
            .tab-content { display: none; }
            .tab-content.active-print { display: block !important; }
            .data-table { font-size: 11px; width: 100%; border: 1px solid #000; }
            .data-table th, .data-table td { border: 1px solid #000 !important; color: black; padding: 4px !important; }
            .data-table th { background-color: #eee !important; font-weight: bold; }
            .print-header-date { display: block !important; font-size: 14px; font-weight: bold; margin-bottom: 10px; text-align: right; width: 100%; border-bottom: 1px solid #000; padding-bottom: 5px; }
            h2 { font-size: 18px !important; margin: 0 0 10px 0 !important; text-align: center; text-transform: uppercase; border: none !important; }
            .print-footer { display: flex !important; justify-content: space-between; margin-top: 40px; padding-top: 10px; }
            .print-footer span { border-top: 1px solid #000; padding-top: 5px; width: 200px; text-align: center; font-weight: bold; }
            #ledgerTab .ledger-print-head { display: block !important; margin-bottom: 20px; border-bottom: 2px solid #000; padding-bottom: 10px; }
            .ledger-info-grid { display: flex; justify-content: space-between; margin-top: 10px; border: 1px solid #000; padding: 10px; background: #f9f9f9 !important; }
            .ledger-box { width: 48%; }
            #ledgerTab .data-table th { background-color: #333 !important; color: white !important; }
            .ledger-summary-grid { border-top: 2px solid #000; margin-top: 10px; justify-content: flex-end; gap: 10px; }
            .ls-item { border: 1px solid #000; background: white !important; min-width: 100px; padding: 5px 10px; box-shadow: none; border-radius: 0; }
        }
        
        /* Modal */
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; }
        .modal-content { background: white; margin: 5% auto; padding: 20px; width: 90%; max-width: 500px; border-radius: 8px; box-shadow: 0 4px 15px rgba(0,0,0,0.2); max-height: 90vh; overflow-y: auto; }
    </style>
</head>
<body>

<div id="loginOverlay">
    <div class="login-box">
        <h2 style="color:#3498db; border-bottom:2px solid #3498db; padding-bottom:10px;">SECURE LOGIN</h2>
        <p>Ram Kishan's Sweets</p>
        <input type="email" id="loginEmail" placeholder="Enter Email" value="">
        <input type="password" id="loginPass" placeholder="Enter Password" value="">
        <button class="btn btn-primary" style="width:100%; font-size:16px;" id="btnLogin">Login System</button>
        <p id="loginMsg" style="color:red; font-size:12px; margin-top:10px;"></p>
    </div>
</div>

<div class="container" id="mainApp" style="display:none;">
    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px; border-bottom:3px solid #3498db; padding-bottom:10px;">
        <h1 style="border:none; margin:0; padding:0; font-size:24px;">Ram Kishan's Sweets - Cloud Manager</h1>
        <div style="display:flex; align-items:center;">
            <button class="bell-btn" id="btnNotif" title="Notifications">
                üîî <div class="bell-dot" id="bellDot"></div>
            </button>
            <button class="btn btn-logout" style="margin:0; margin-top:0;" id="btnLogout">Logout üîí</button>
        </div>
    </div>

    <div class="tab-menu" id="tabMenu">
        <button class="tab-button active" data-tab="addOrder">New Order</button>
        <button class="tab-button" data-tab="productionTab">Production</button>
        <button class="tab-button" data-tab="packingTab">Packing</button>
        <button class="tab-button" data-tab="splitTab">Split Delivery üìÖ</button>
        <button class="tab-button" data-tab="masterSummaryTab">Delivery Schedule üìã</button>
        <button class="tab-button" data-tab="todaySummary">Today's Summary</button>
        <button class="tab-button" data-tab="monthReport">Monthly Report</button>
        <button class="tab-button" data-tab="duePayments">Due Payments</button>
        <button class="tab-button" data-tab="allOrders">All Orders</button>
        <button class="tab-button" data-tab="ledgerTab">Customer Ledger</button>
        <button class="tab-button" data-tab="expensesTab">Expenses</button>
        <button class="tab-button" data-tab="reportsTab">System Admin</button>
    </div>

    <div id="addOrder" class="tab-content active-print" style="display: block;">
        <h2>Create New Order</h2>
        <form id="orderForm">
            <input type="hidden" id="orderId">
            <div class="form-row">
                <div class="form-group"><label>Order No.</label><input type="text" id="orderNo" list="orderNoList" autocomplete="off" required></div>
                <datalist id="orderNoList"></datalist>

                <div class="form-group"><label>Order Date</label><input type="date" id="orderDate" required></div>
                <div class="form-group"><label>Main Delivery Date</label><input type="date" id="deliveryDate" required></div>
                <div class="form-group"><label>Delivery Time</label><input type="time" id="deliveryTime"></div>
            </div>
            <div class="form-row">
                <div class="form-group" style="flex: 2;"><label>Customer Name</label><input type="text" id="customerName" list="custList" autocomplete="off" required></div>
                <datalist id="custList"></datalist>

                <div class="form-group"><label>Mobile</label><input type="tel" id="mobile"></div>
                <div class="form-group">
                    <label>Order Type</label>
                    <select id="orderType">
                        <option value="REGULAR">Regular</option>
                        <option value="BHAJI">Bhaji</option>
                        <option value="SNACKS">Snacks</option>
                        <option value="DIWALI">Diwali</option>
                        <option value="CUSTOM">Custom</option>
                    </select>
                </div>
            </div>

            <h3>üì¶ Box Configurations</h3>
            <div id="boxContainer"></div>
            <button type="button" class="btn btn-primary" id="btnAddBoxGroup">+ Add New Box Group</button>
            <hr>

            <div class="form-row" style="margin-top: 20px; align-items: flex-end;">
                <div class="form-group"><label>Sub Total</label><input type="number" id="subTotal" readonly></div>
                <div class="form-group"><label style="color:#c0392b;">Discount</label><input type="number" id="discount" value="0"></div>
                <div class="form-group"><label style="color:#27ae60; font-weight:bold;">Net Amount</label><input type="number" id="totalAmount" readonly></div>
            </div>

            <div class="form-row" style="margin-top: 10px; align-items: flex-end;">
                <div class="form-group"><label>Advance Paid</label><input type="number" id="advancePaid" value="0" step="0.01"></div>
                <div class="form-group"><label style="color:#d35400;">Payment Date</label><input type="date" id="advanceDate" style="border:1px solid #d35400;"></div>
                <div class="form-group"><label>Payment Mode</label><select id="paymentMode" class="payment-select"></select></div>
                <div class="form-group"><label>Balance Due</label><input type="number" id="balanceShow" readonly></div>
            </div>
            
            <div class="form-row"><div class="form-group"><label>Order Note</label><input type="text" id="orderRemark" placeholder="Special Instructions..."></div></div>

            <button type="submit" class="btn btn-success">Save Order (Cloud)</button>
        </form>
    </div>

    <div id="productionTab" class="tab-content">
        <h2>Kitchen / Production List</h2>
        <div class="print-header-date" id="printDateProd"></div>
        <div class="form-row filter-controls-screen">
            <div class="form-group"><label>Preparation Date (Showing Orders due +2 days)</label><input type="date" id="prodDateFilter"></div>
            <div class="form-group"><label>Search Item</label><input type="text" id="prodSearchFilter" placeholder="Search..."></div>
            <div class="form-group"><label style="color:#d35400; font-weight:bold;">Report Prepared By*</label><input type="text" id="prodSignInput" placeholder="Name..."></div>
            <div class="form-group" style="align-self: flex-end;"><button class="btn btn-primary" id="btnPrintProd">Print List</button></div>
        </div>
        <div class="table-responsive">
            <table class="data-table" id="productionTable">
                <thead><tr><th style="width:30%">Item Name</th><th style="width:15%">Total Quantity</th><th style="width:20%">Delivery Date</th><th style="width:35%">Remarks</th></tr></thead>
                <tbody></tbody>
            </table>
        </div>
        <div class="print-footer">
            <span>Prepared By: <b id="prodSignDisplay"></b></span>
            <span>Manager Check</span>
        </div>
    </div>

    <div id="packingTab" class="tab-content">
        <h2>Packing & Dispatch</h2>
        <div class="print-header-date" id="printDatePack"></div>
        <div class="form-row filter-controls-screen">
            <div class="form-group"><label>Packing Date (Showing Orders due +1 day)</label><input type="date" id="packDateFilter"></div>
            <div class="form-group"><label>Search</label><input type="text" id="packSearchFilter" placeholder="Search..."></div>
            <div class="form-group"><label style="color:#d35400; font-weight:bold;">Checked By*</label><input type="text" id="packSignInput" placeholder="Name..."></div>
            <div class="form-group" style="align-self: flex-end;"><button class="btn btn-primary" id="btnPrintPack">Print List</button></div>
        </div>
        <div class="table-responsive">
            <table class="data-table" id="packingTable">
                <thead><tr><th style="width:12%">Time</th><th style="width:20%">Customer</th><th style="width:40%">Details</th><th style="width:15%">Delivery Date</th><th style="width:13%">Notes</th></tr></thead>
                <tbody></tbody>
            </table>
        </div>
        <div class="print-footer">
            <span>Packed By: <b id="packSignDisplay"></b></span>
            <span>Dispatched By</span>
        </div>
    </div>

    <div id="splitTab" class="tab-content">
        <h2>üìÖ Delivery Status & Split Manager</h2>
        <div class="form-row filter-controls-screen" style="background:#fce4ec; padding:15px; border-radius:8px; border:1px solid #f8bbd0;">
            <div class="form-group"><label>Search Order / Customer</label><input type="text" id="splitSearchInput" placeholder="Name or Order No..."></div>
        </div>
        <p style="font-size:12px; color:#555;">Check Pending Status, Split Deliveries, or Update Dates.</p>
        <div id="splitResultsContainer" style="margin-top:20px;"></div>
    </div>

    <div id="masterSummaryTab" class="tab-content">
        <h2>üìã Delivery Schedule & Status</h2>
        <div class="form-row filter-controls-screen" style="background:#e0f7fa; padding:15px; border-radius:8px; border:1px solid #b2ebf2;">
            <div class="form-group"><label>Filter by Delivery Date (Empty for All)</label><input type="date" id="masterDateFilter"></div>
            <div class="form-group"><label>Search (Customer, Order No)</label><input type="text" id="masterSearch" placeholder="Name or Order#..."></div>
            <div class="form-group" style="align-self: flex-end;"><button class="btn btn-primary" onclick="window.print()">Print Schedule</button></div>
        </div>
        <div class="print-header-date" id="printDateMaster"></div>
        <div class="table-responsive">
            <table class="data-table" id="masterTable">
                <thead><tr><th style="width:15%">Date & Time</th><th style="width:10%">Order No</th><th style="width:20%">Customer</th><th style="width:30%">Delivery Details (Boxes)</th><th style="width:25%">Status / Action</th></tr></thead>
                <tbody></tbody>
            </table>
        </div>
    </div>

    <div id="todaySummary" class="tab-content">
        <h2>Daily Summary Report</h2>
        <div class="print-header-date" id="printDateSum"></div>
        <div class="form-row filter-controls-screen">
            <div class="form-group"><label>Select Report Date</label><input type="date" id="summaryDateFilter"></div>
            <div class="form-group"><label style="color:#d35400; font-weight:bold;">Report By*</label><input type="text" id="sumSignInput" placeholder="Name..."></div>
            <div class="form-group" style="align-self: flex-end;"><button class="btn btn-primary" id="btnPrintSummary">Print Summary</button></div>
        </div>
        <div id="summaryDashboard"></div>
        <table class="data-table" id="summaryTable">
            <thead><tr><th style="width:8%">Order</th><th style="width:10%">Del. Date</th><th style="width:15%">Customer</th><th style="width:25%">Box Details</th><th style="width:12%">Bill Amount</th><th style="width:20%">Paid Details (Hist)</th><th style="width:10%">Due</th></tr></thead>
            <tbody></tbody>
        </table>
        <h3 style="margin-top:30px; border-left:5px solid #c62828; padding-left:10px; color:#c0392b;">Today's Expenses</h3>
        <table class="data-table" id="summaryExpenseTable">
            <thead><tr><th style="width:50%">Expense Detail</th><th style="width:25%">Mode</th><th style="width:25%">Amount</th></tr></thead>
            <tbody></tbody>
        </table>
        <h3 style="margin-top:30px; border-left:5px solid #2980b9; padding-left:10px; color:#2980b9;">Cashier Wise Collection (Staff)</h3>
        <table class="data-table" id="cashierSummaryTable">
            <thead><tr><th style="width:30%">Cashier Name</th><th style="width:15%; text-align:right;">Cash Sale</th><th style="width:15%; text-align:right;">Online Sale</th><th style="width:20%; text-align:right; color:#c0392b;">Less: Expense</th><th style="width:20%; text-align:right; font-weight:bold; color:#27ae60;">Net Cash Handover</th></tr></thead>
            <tbody></tbody>
        </table>
        <div class="print-footer"><span>Generated By: <b id="sumSignDisplay"></b></span><span>Owner Sign</span></div>
    </div>

    <div id="monthReport" class="tab-content">
        <h2>Monthly Reports</h2>
        <div class="print-header-date" id="printDateMonth"></div>
        <div class="form-row filter-controls-screen">
            <div class="form-group"><label>Select Month</label><input type="month" id="monthInput"></div>
            <div class="form-group" style="align-self: flex-end;">
                <button class="btn btn-warning" id="btnAddIncome">+ Add Daily Income</button>
                <button class="btn btn-primary" onclick="window.print()">Print Report</button>
            </div>
        </div>
        <div id="monthDashboard"></div>
        <h3 style="margin-top:20px;">Daily Breakdown</h3>
        <table class="data-table" id="monthTable">
            <thead><tr><th style="width:10%">Date</th><th style="width:5%">Ord</th><th style="width:10%; text-align:right;">Sweets</th><th style="width:10%; text-align:right; color:#d35400;">Rest. Cash</th><th style="width:10%; text-align:right; color:#e67e22;">Rest. UPI</th><th style="width:10%; text-align:right; color:#8e44ad;">Show. Cash</th><th style="width:10%; text-align:right; color:#9b59b6;">Show. UPI</th><th style="width:10%; text-align:right; color:#27ae60; font-weight:bold;">Total Inc.</th><th style="width:10%; text-align:right; color:#c0392b;">Exp</th><th style="width:10%; text-align:right;">Net Profit</th></tr></thead>
            <tbody id="monthTableBody"></tbody>
        </table>
        <h3 class="no-print" style="margin-top:30px; border-left:5px solid #f39c12; padding-left:10px;">Restaurant & Showroom Income Log</h3>
        <table class="data-table no-print" id="otherIncomeTable">
            <thead><tr><th>Date</th><th>Source / Cashier</th><th>Amount</th><th>Mode</th><th class="filter-controls-screen">Action</th></tr></thead>
            <tbody></tbody>
        </table>
    </div>

    <div id="duePayments" class="tab-content">
        <h2>Due Payments</h2>
        <div class="form-row filter-controls-screen" style="background:#fff3e0; padding:10px; border-radius:8px;">
             <div class="form-group"><label>Filter by Order Date</label><input type="date" id="dueDetailDate"></div>
             <div class="form-group"><label>Search</label><input type="text" id="dueSearchInput" placeholder="Name or Order No..."></div>
             <div class="form-group" style="align-self: flex-end;"><button class="btn btn-primary" id="btnRefreshDue">Refresh</button> <button class="btn btn-warning" onclick="window.print()">Print List</button></div>
        </div>
        <table class="data-table" id="dueTable" style="margin-top:10px;">
            <thead><tr><th>Date</th><th>Order</th><th>Customer</th><th>Total</th><th>Paid</th><th>Due</th><th class="filter-controls-screen">Action</th></tr></thead>
            <tbody></tbody>
        </table>
    </div>

    <div id="allOrders" class="tab-content">
        <h2>All Orders</h2>
        <div class="form-row filter-controls-screen" style="background:#e3f2fd; padding:10px; border-radius:8px;">
            <div class="form-group"><label>From Date</label><input type="date" id="searchFromDate"></div>
            <div class="form-group"><label>To Date</label><input type="date" id="searchToDate"></div>
            <div class="form-group"><label>Search Order</label><input type="text" id="searchOrder" placeholder="Search..."></div>
        </div>
        <table class="data-table" id="allOrdersTable">
            <thead><tr><th>Date</th><th>Order</th><th>Customer</th><th>Box Summary</th><th>Amount</th><th class="filter-controls-screen">Action</th></tr></thead>
            <tbody></tbody>
        </table>
    </div>

    <div id="ledgerTab" class="tab-content">
        <div class="ledger-print-head">
            <h1 class="lp-company-name">RAM KISHAN'S SWEETS</h1>
            <p class="lp-subtitle">Statement of Account</p>
            <div class="ledger-info-grid">
                <div class="ledger-box"><strong>Bill To:</strong> <span id="printLedgerCustName" style="font-size:16px; text-transform:uppercase;"></span><br><span id="printLedgerMobile"></span></div>
                <div class="ledger-box" style="text-align:right;"><strong>Details:</strong> Date: <span id="printLedgerDate"></span></div>
            </div>
        </div>
        <h2>Customer Ledger</h2>
        <div class="form-row filter-controls-screen">
            <div class="form-group"><label>Select Customer</label><select id="ledgerCustomerSelect"><option value="">-- Select Customer --</option></select></div>
            <div class="form-group" style="align-self: flex-end;"><button class="btn btn-primary" onclick="window.print()">Print Formal Statement</button></div>
        </div>
        <div id="ledgerContent" style="display:none;">
            <div class="table-responsive">
                <table class="data-table" id="ledgerTable">
                    <thead><tr><th style="width:15%">Date</th><th style="width:40%">Description</th><th style="width:15%; text-align:right;">Debit</th><th style="width:15%; text-align:right;">Credit</th><th style="width:15%; text-align:right;">Balance</th><th class="filter-controls-screen" style="width:10%">Action</th></tr></thead>
                    <tbody></tbody>
                </table>
            </div>
            <div class="ledger-summary-grid">
                <div class="ls-item debit"><h4>Total Bill</h4><div class="value" id="ledgerTotalDebit"></div></div>
                <div class="ls-item credit"><h4>Total Paid</h4><div class="value" id="ledgerTotalCredit"></div></div>
                <div class="ls-item balance"><h4>Net Balance Due</h4><div class="value" id="ledgerBalance"></div></div>
            </div>
            <div class="print-footer"><span>Customer Sign</span><span>Authorized Signatory</span></div>
        </div>
    </div>

    <div id="expensesTab" class="tab-content">
        <h2>Expense Management</h2>
        <div class="form-row filter-controls-screen" style="background:#fff0f0; padding:15px; border-radius:8px; border:1px solid #ffcccc;">
            <div class="form-group"><label>Date</label><input type="date" id="expDate"></div>
            <div class="form-group"><label>Amount</label><input type="number" id="expAmt"></div>
            <div class="form-group"><label>Payment Mode</label><select id="expMode" class="payment-select"></select></div>
            <div class="form-group"><label>Select Cashier</label><select id="expCashier"><option value="">-- Owner / General --</option><option value="Lokendra">Lokendra</option><option value="Vikash">Vikash</option><option value="Nipul">Nipul</option><option value="Dubey">Dubey</option><option value="Arpit">Arpit</option><option value="Extra Cash">Extra Cash</option></select></div>
            <div class="form-group"><label>Details</label><input type="text" id="expDetail" placeholder="Rent, Tea, Salary, etc"></div>
            <div class="form-group" style="align-self: flex-end;"><button class="btn btn-danger" id="btnAddExpense">Add Expense</button></div>
        </div>
        <div class="table-responsive">
            <table class="data-table" id="expenseTable">
                <thead><tr><th>Date</th><th>Detail</th><th>Spent By</th><th>Amount</th><th>Mode</th><th class="filter-controls-screen">Action</th></tr></thead>
                <tbody></tbody>
            </table>
        </div>
    </div>

    <div id="reportsTab" class="tab-content">
        <h2>System Administration</h2>
        <div class="admin-grid">
            <div class="admin-card" style="border-top-color: #f39c12;">
                <span class="icon-large">üìÇ</span><h3>Backup Data (Export)</h3><p>Download backup.</p>
                <button class="btn btn-warning" id="btnExport">Download Backup (Pass)</button>
            </div>
            <div class="admin-card" style="border-top-color: #3498db;">
                <span class="icon-large">üì•</span><h3>Restore Data (Import)</h3><p>Restore from file.</p>
                <button class="btn btn-primary" id="btnImport">Restore Backup (Pass)</button>
                <input type="file" id="importFile" style="display:none">
            </div>
            <div class="admin-card" style="border-top-color: #c0392b;">
                <span class="icon-large">üóëÔ∏è</span><h3>Reset System</h3><p>Delete ALL Data.</p>
                <button class="btn btn-danger" id="btnReset">Delete All Data (Pass)</button>
            </div>
            <div class="admin-card" style="border-top-color: #27ae60;">
                <span class="icon-large">üìä</span><h3>Cloud Status</h3>
                <div style="text-align:left; padding:0 15px;">
                    <div style="margin-bottom:5px;">Orders: <span class="stat-badge" id="statOrders">0</span></div>
                    <div>Ledger Entries: <span class="stat-badge" id="statLedger">0</span></div>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="notificationModal" class="modal">
    <div class="modal-content">
        <div style="display:flex; justify-content:space-between; align-items:center; border-bottom:1px solid #eee; padding-bottom:10px;">
            <h3 style="margin:0;">üîî Pending Deliveries</h3>
            <button class="btn btn-sm btn-danger" onclick="document.getElementById('notificationModal').style.display='none'">Close</button>
        </div>
        <div id="bulkActionContainer" style="margin: 10px 0; display:none; text-align:center;">
            <button class="btn btn-warning" style="width:100%" id="btnBulkDelivered">‚úÖ Mark All Previous as Delivered</button>
        </div>
        <div id="notifList" style="margin-top:15px; max-height: 60vh; overflow-y:auto;"></div>
    </div>
</div>

<div id="payModal" class="modal">
    <div class="modal-content">
        <h3>Add Payment</h3>
        <input type="hidden" id="modalOrderId">
        <label>Date</label><input type="date" id="modalPayDate" style="margin-bottom:10px;">
        <label>Amount</label><input type="number" id="modalPayAmt" placeholder="Amount" style="margin-bottom:10px;">
        <label>Discount (Optional)</label><input type="number" id="modalDiscount" placeholder="Discount" style="margin-bottom:10px;">
        <label>Mode</label><select id="modalPayMode" class="payment-select" style="margin-bottom:10px;"></select>
        <div style="display:flex; gap:10px; margin-top:10px;">
            <button class="btn btn-success" style="flex:1" id="btnSavePayment">Save</button>
            <button class="btn btn-danger" style="flex:1" onclick="document.getElementById('payModal').style.display='none'">Cancel</button>
        </div>
    </div>
</div>

<div id="editPayModal" class="modal">
    <div class="modal-content">
        <h3>Edit Payment</h3>
        <input type="hidden" id="editPayId">
        <label>Date</label><input type="date" id="editPayDate" style="margin-bottom:10px;">
        <label>Amount</label><input type="number" id="editPayAmt" style="margin-bottom:10px;">
        <label>Mode</label><select id="editPayMode" class="payment-select" style="margin-bottom:10px;"></select>
        <div style="display:flex; gap:10px; margin-top:10px;">
            <button class="btn btn-primary" style="flex:1" id="btnUpdatePayment">Update</button>
            <button class="btn btn-danger" style="flex:1" onclick="document.getElementById('editPayModal').style.display='none'">Cancel</button>
        </div>
    </div>
</div>

<div id="incomeModal" class="modal">
    <div class="modal-content">
        <h3 id="incModalTitle">Add Other Daily Income</h3>
        <input type="hidden" id="incId"> <label>Date</label><input type="date" id="incDate" style="margin-bottom:10px;">
        <label>Source</label><select id="incSource" style="margin-bottom:10px;"><option value="Showroom">Showroom Sale</option><option value="Restaurant">Restaurant Sale</option></select>
        <label>Select Cashier</label><select id="incCashier" style="margin-bottom:10px;"></select>
        <label>Amount</label><input type="number" id="incAmt" placeholder="Total Amount" style="margin-bottom:10px;">
        <label>Mode</label><select id="incMode" style="margin-bottom:10px;"><option value="Cash">Cash</option><option value="Counter Pay">Counter Pay</option><option value="UPI">UPI</option><option value="Card">Card</option><option value="Bank Transfer">Bank Transfer</option></select>
        <div style="display:flex; gap:10px; margin-top:10px;">
            <button id="incSaveBtn" class="btn btn-success" style="flex:1">Save Income</button>
            <button class="btn btn-danger" style="flex:1" onclick="document.getElementById('incomeModal').style.display='none'">Cancel</button>
        </div>
    </div>
</div>

<script type="module" src="app.js"></script>
</body>
</html>
